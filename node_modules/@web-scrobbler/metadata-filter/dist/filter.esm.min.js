/*
 * @web-scrobbler/metadata-filter v3.1.0
 * (c) Web Scrobbler MetadataFilter Team
 * Licensed under the MIT License
 */
function e(e){Array.isArray(e)?e.forEach(r):r(e)}function r(e){if("function"!=typeof e)throw new TypeError(`Invalid filter function: expected 'function', got '${typeof e}'`)}function t(e){return new i(e)}function s(r,t){return function(e){if(!Array.isArray(e))throw new TypeError(`Invalid 'fields' argument: expected 'string[]', got '${typeof e}'`);if(0===e.length)throw new Error("Invalid 'fields' argument: received an empty array");for(const r of e){if("string"!=typeof r)throw new TypeError(`Invalid field: expected 'string', got '${typeof r}'`);if(!r)throw new TypeError("Invalid field: expected 'string', got an empty string")}}(r),e(t),r.reduce(((e,r)=>(e[r]=t,e)),{})}class i{constructor(e){this.mergedFilterSet={},this.appendFilters(e)}filterField(e,r){if(e in this.mergedFilterSet)return this.filterText(r,this.mergedFilterSet[e]);throw new TypeError(`Invalid filter field: ${e}`)}append(e){return this.appendFilters(e),this}extend(e){if(!e)throw new TypeError("No filter is specified!");if(!(e instanceof i))throw new TypeError(`Invalid filter: expected 'MetadataFilter', got '${typeof e}'`);return this.appendFilters(e.mergedFilterSet),this}canFilterField(e){return e in this.mergedFilterSet}getFields(){return Object.keys(this.mergedFilterSet)}filterText(e,r){return e?r.reduce(((e,r)=>r(e)),e):e}wrapFiltersIntoArray(e){if(Array.isArray(e))return e;return[e]}appendFilters(r){!function(r){if(!r)throw new TypeError("No filter set is specified!");if("object"!=typeof r)throw new TypeError(`Invalid filter set: expected 'object', got '${typeof r}'`);for(const t in r)e(r[t])}(r);for(const e in r){e in this.mergedFilterSet||(this.mergedFilterSet[e]=[]);const t=this.wrapFiltersIntoArray(r[e]);this.mergedFilterSet[e].push(...t)}}}const o=[{source:/\s[([]Explicit[)\]]/i,target:""},{source:/\s[([]Clean[)\]]/i,target:""}],n=[{source:/\s[([]feat. .+[)\]]/i,target:""}],u=[{source:/\s-\sLive(\s.+)?$/,target:""},{source:/\s[([]Live[)\]]$/,target:""}],a=[{source:/\s[([](feat. .+)[)\]]/i,target:" $1"}],c=[{source:/\s\(Parody of ".*" by .*\)$/,target:""},{source:/\s\(Parody of ".*" by .* feat\. .*\)$/,target:""},{source:/\s\(Lyrical Adaption of ".*"\)$/,target:""}],g=[{source:/\sRe-?issue$/i,target:""},{source:/\s\[.*?Re-?issue.*?\]/i,target:""},{source:/\s\(.*?Re-?issue.*?\)/i,target:""}],f=[{source:/Live\s\/\sRemastered/,target:"Live"},{source:/\s[([].*Re-?[Mm]aster(ed)?.*[)\]]$/,target:""},{source:/\s-\s\d{4}(\s-)?\s.*Re-?[Mm]aster(ed)?.*$/,target:""},{source:/\s-\sRe-?[Mm]aster(ed)?.*$/,target:""},{source:/\s\[Remastered\]\s\(Remastered\sVersion\)$/,target:""}],l=[{source:/-\s(.+?)\s((Re)?mix|edit|dub|mix|vip|version)$/i,target:"($1 $2)"},{source:/-\s(Remix|VIP|Instrumental)$/i,target:"($1)"}],d=[{source:/\(+\s*\)+/,target:""},{source:/^[/,:;~\s"-]+/,target:""},{source:/[/,:;~\s"-]+$/,target:""},{source:/\u0020{1,}/,target:" "}],p=[{source:/(Various Artists).+/,target:"$1"}],$=[{source:/\s[([]Album Version[)\]]$/,target:""},{source:/\s[([]Re-?recorded[)\]]$/,target:""},{source:/\s[([]Single Version[)\]]$/,target:""},{source:/\s[([]Edit[)\]]$/,target:""},{source:/\s-\sMono Version$/,target:""},{source:/\s-\sStereo Version$/,target:""},{source:/\s\(Deluxe Edition\)$/,target:""},{source:/\s[([]Expanded.*[)\]]$/,target:""},{source:/\s-\sExpanded Edition$/,target:""},{source:/\s[([]Explicit Version[)\]]/i,target:""},{source:/\s[([]Bonus Track Edition[)\]]/i,target:""},{source:/\s[([]\d+th\sAnniversary.*[)\]]/i,target:""},{source:/\s-\sOriginal$/i,target:""},{source:/\s-\sOriginal.*Version(\s\d{4})?$/i,target:""}],m=[{source:/^\s+|\s+$/g,target:""},{source:/\*+\s?\S+\s?\*+$/,target:""},{source:/\[[^\]]+\]/,target:""},{source:/【[^\]]+】/,target:""},{source:/（[^\]]+）/,target:""},{source:/\([^)]*version\)$/i,target:""},{source:/\.(avi|wmv|mpg|mpeg|flv)$/i,target:""},{source:/\(.*lyrics?\s*(video)?\)/i,target:""},{source:/\((of+icial\s*)?(track\s*)?stream\)/i,target:""},{source:/\((of+icial\s*)?(music\s*)?(video|audio)\)/i,target:""},{source:/-\s(of+icial\s*)?(music\s*)?(video|audio)$/i,target:""},{source:/\(.*Album\sTrack\)/i,target:""},{source:/\(\s*of+icial\s*\)/i,target:""},{source:/\(\s*[0-9]{4}\s*\)/i,target:""},{source:/\(\s*(HD|HQ)\s*\)$/,target:""},{source:/(HD|HQ)\s?$/,target:""},{source:/(vid[\u00E9e]o)?\s?clip\sof+ici[ae]l/i,target:""},{source:/of+iziel+es\s*video/i,target:""},{source:/vid[\u00E9e]o\s?clip/i,target:""},{source:/\sclip/i,target:""},{source:/full\s*album/i,target:""},{source:/\(live.*?\)$/i,target:""},{source:/\|.*$/i,target:""},{source:/^(|.*\s)"(.{5,})"(\s.*|)$/,target:"$2"},{source:/^(|.*\s)'(.{5,})'(\s.*|)$/,target:"$2"},{source:/\(.*[0-9]{1,2}\/[0-9]{1,2}\/[0-9]{2,4}.*\)/i,target:""},{source:/sub\s*español/i,target:""},{source:/\s\(Letra\)/i,target:""},{source:/\s\(En\svivo\)/i,target:""},{source:/sub\s*español/i,target:""}],y={"&":/&amp;/g,"<":/&lt;/g,">":/&gt;/g,'"':/&quot;/g};function h(e){return e.includes(" feat. ")?e.split(" feat. ")[0]:e}function v(e){let r=e;for(const e in y){const t=y[e];r=r.replace(t,e)}return r=r.replace(/&#x([a-fA-f0-9]+);/g,((e,r)=>{const t=parseInt(r,16);return String.fromCharCode(t)})),r=r.replace(/&#(\d+);/g,((e,r)=>String.fromCharCode(r))),r}function w(e,r){return r.reduce(((e,r)=>{const{source:t,target:s}=r;return e.replace(t,s)}),e)}function E(e){return w(e,l)}function F(e){return w(e,p)}function x(e){return w(e,a)}function b(e){return w(e,o)}function A(e){return w(e,n)}function S(e){return w(e,u)}function I(e){return w(e,c)}function T(e){return w(e,g)}function R(e){return w(e,f)}function k(e){return w(e,$)}function V(e){return e.replace(/[\u200B-\u200D\uFEFF]/g,"")}function L(e){return e.replace(/\u00a0/g," ")}function C(e){return w(e,[...m,...d])}function M(e){return e.replace(/[\u2018\u2019]/g,"'").replace(/[\u201c\u201d]/g,'"')}function D(){return new i({track:C})}function H(){return new i({track:R,album:R})}function j(){return new i({track:[R,I,E,S],album:[R,E,S,T,k]})}function O(){return new i({artist:[x],track:[b,A,R,E,k,S],album:[v,b,R,E,k,S],albumArtist:[x,h]})}function P(){return new i({track:[R,E,k,S],album:[R,E,k,S]})}export{i as MetadataFilter,h as albumArtistFromArtist,O as createAmazonFilter,t as createFilter,s as createFilterSetForFields,H as createRemasteredFilter,j as createSpotifyFilter,P as createTidalFilter,D as createYouTubeFilter,v as decodeHtmlEntities,w as filterWithFilterRules,E as fixTrackSuffix,F as fixVariousArtists,x as normalizeFeature,b as removeCleanExplicit,A as removeFeature,S as removeLive,I as removeParody,T as removeReissue,R as removeRemastered,k as removeVersion,V as removeZeroWidth,L as replaceNbsp,M as replaceSmartQuotes,C as youtube};
